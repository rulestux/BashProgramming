## 108.2 System Logs
__weight 4__


### rsyslogd
- daemon do rsyslog;

### klogd
- daemon que trabalha junto com o rsyslog para registro de logs do kernel;

### /etc/rsyslog.conf
- arquivo de configuração do rsyslog;
- também podem ser inseridas regras para o rsyslog em '/etc/ryslog.d/';
- sessões do arquivo:
	- MODULES: suporte modular para registro de eventos, capacidade de mensagem e recepção de log UDP/TCP;
	- GLOBAL DIRECTIVES: configuração de logs e permissões de diretório de logs;
	- RULES: recursos, prioridades e ações, com a sintaxe: ```<facility>.<priority> <action>```;

__Recurso \(facility)__

| número 	| palavra-chave 	| descrição 					|
|-----------|-------------------|-------------------------------|
| 0 		| kern 				| mensagens do kernel 			|
| 1 		| user 				| mensagens de nível do usuário |
| 2 		| mail 				| sistema de email 				|
| 3			| daemon			| daemons do sistema 			|	
| 4			| auth, authpriv	| segurança 					|
| 5			| syslog			| syslogd 						|
| 6			| lpr				| impressora de linha 			|
| 7			| news				| notícia de rede 				|
| 8			| uucp				| Unix-to-Unix Copy Protocol 	|
| 9			| cron				| daemon do relógio 			|
| 10		| auth, authpriv	| segurança 					|
| 11		| ftp				| daemon FTP 					|
| 12		| ntp				| daemon NTP 					|
| 13		| security			| auditoria do log 				|
| 14		| console			| alerta do log 				|
| 15		| cron				| daemon do relógio 			|
| 16-23		| local0 - local7	| uso local 0-7 				|
|-----------|-------------------|-------------------------------|

__Prioridades \(priority)__

| número 	| gravidade		 	| palavra-chave 	| descrição 					|
|-----------|-------------------|-------------------|-------------------------------|
| 0 		| emergência		| emerg, panic		| sistema inutilizável 			|
| 1 		| alerta			| alert				| agir imediatamente			|
| 2 		| crítico			| crit 				| condição crítica				|
| 3			| erro				| err, error		| condição de erro				|	
| 4			| aviso				| warn, warning		| condição de aviso				|
| 5			| atenção			| notice			| normal, mas com importância	|
| 6			| informativo		| info				| mensagem informativa 			|
| 7			| debug				| debug				| mensagem de depuração			|
|-----------|-------------------|-------------------|-------------------------------|

### /var/log/
- diretório onde se encontram logs de sistema, de serviços e de programas;
	- '/var/log/auth.log' arquivo de logs de processos de autenticação, cron jobs etc.;
	- '/var/log/syslog' logs centralizados do rsyslog;
	- '/var/log/debug' depuração de programas;
	- '/var/log/kern.log' mensagens do kernel;
	- '/var/log/messages' mensagens informativas de serviços e de servidor de log centralizado;
	- '/var/log/mail.log' servidor de email, feito postfix;
	- '/var/log/Xorg.0.log' placa de vídeo;
	- '/var/run/utmp' e '/var/log/wtmp' logins bem sucedidos;
	- '/var/log/btmp' logins mal sucedidos, como ataques de força bruta via SSH;
	- '/var/log/faillog' tentativas de autenticação mal sucedidas;
	- '/var/log/lastlog' data e hora de logins de usuário;
	- '/var/log/cups/' diretório para logs do CUPS: error_log, page_lot e access_log;
	- '/var/log/apache2/' ou '/var/log/httpd/' logs do Apache:  access.log, error_log e other_vhosts_access.log;
	- '/var/log/mysql/' logs do MySQL: error_log, mysql.log e mysql-slow.log;
	- '/var/log/samba/' logs do protocolo Session Message Block \(SMB): log., log.nmbd and log.smbd;
	- '/var/log/dpkg.log' logs do dpkg;

- o conteúdo dos logs segue a sintaxe:
	- data/hora;
	- nome do host de origem da mensagem;
	- nome do programa ou do serviço;
	- PID do programa;
	- descrição da ação.

### zless and zmore
- utilitários equivalentes a less e more para a leitura de logs compactados com gzip, função exercida por logrotate;

### who ou w
- permite ver logs do binário '/var/log/wtmp';

### last -f
- permite ver logs do binário '/var/log/btmp';

### faillog -a | less
- permite ver logs do binário '/var/log/faillog';

### lastlog | less
- permite ver logs do binário '/var/log/lastlog';

### Special Log Files
- /dev/log;
- /dev/kmsg.
